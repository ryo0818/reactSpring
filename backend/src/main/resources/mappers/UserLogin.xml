<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.repository.UserLoginRepository">

	<resultMap id="RegUserResultMap"
		type="com.example.demo.entity.RegUserEntity">
		<id property="id" column="id" />
		<result property="email" column="email" />
		<result property="mycompanycode" column="mycompanycode" />
		<result property="validStartDate" column="validstartdate" />
		<result property="validEndDate" column="validenddate" />
		<result property="adminLevel" column="adminlevel" />
		<result property="validFlg" column="validflg" />
		<result property="username" column="username" />
		<result property="myteamcode" column="myteamcode" />
	</resultMap>

	<select id="getUserInfo" parameterType="string"
		resultMap="RegUserResultMap">
		select
		id,
		email,
		mycompanycode ,
		validstartdate,
		validenddate ,
		adminlevel ,
		validflg ,
		username ,
		myteamcode
		FROM reguser
		where reguser.id = #{userId}
		and reguser.email = #{email}
	</select>

	<select id="checkCompanyCode"
		parameterType="string"
		resultType="int">
		SELECT
		count(*)
		FROM reguser
		WHERE mycompanycode = #{mycompanycode}
	</select>

	<select id="checkTeamCode"
		parameterType="string"
		resultType="int">
		SELECT
		count(*)
		FROM reguser
		WHERE myteamcode = #{myteamcode}
	</select>

	<insert id="insertUser"
		parameterType="com.example.demo.entity.StatusEntity">
		INSERT INTO public.reguser
		(id, email, mycompanycode, validstartdate, validenddate, adminlevel,
		validflg,myteamcode)
		VALUES
		(#{id}, #{email}, #{mycompanycode}, #{validStartDate}, #{validEndDate},
		#{adminLevel}, #{validFlg},#{myteamcode})
	</insert>
</mapper>
